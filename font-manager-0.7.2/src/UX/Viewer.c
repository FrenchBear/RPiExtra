/* Viewer.c generated by valac 0.26.1, the Vala compiler
 * generated from Viewer.vala, do not modify */

/* Viewer.vala
 *
 * Copyright (C) 2009 - 2015 Jerry Casiano
 *
 * This file is part of Font Manager.
 *
 * Font Manager is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Font Manager is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Font Manager.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Author:
 *        Jerry Casiano <JerryCasiano@gmail.com>
*/

#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <gio/gio.h>
#include <gee.h>
#include <stdlib.h>
#include <string.h>
#include <gdk/gdk.h>
#include <glib/gi18n-lib.h>
#include <pango/pango.h>


#define FONT_MANAGER_TYPE_VIEWER (font_manager_viewer_get_type ())
#define FONT_MANAGER_VIEWER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_TYPE_VIEWER, FontManagerViewer))
#define FONT_MANAGER_VIEWER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_TYPE_VIEWER, FontManagerViewerClass))
#define FONT_MANAGER_IS_VIEWER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_TYPE_VIEWER))
#define FONT_MANAGER_IS_VIEWER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_TYPE_VIEWER))
#define FONT_MANAGER_VIEWER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_TYPE_VIEWER, FontManagerViewerClass))

typedef struct _FontManagerViewer FontManagerViewer;
typedef struct _FontManagerViewerClass FontManagerViewerClass;
typedef struct _FontManagerViewerPrivate FontManagerViewerPrivate;

#define FONT_MANAGER_TYPE_FONT_DATA (font_manager_font_data_get_type ())

#define TYPE_CACHEABLE (cacheable_get_type ())
#define CACHEABLE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_CACHEABLE, Cacheable))
#define CACHEABLE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_CACHEABLE, CacheableClass))
#define IS_CACHEABLE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_CACHEABLE))
#define IS_CACHEABLE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_CACHEABLE))
#define CACHEABLE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_CACHEABLE, CacheableClass))

typedef struct _Cacheable Cacheable;
typedef struct _CacheableClass CacheableClass;

#define FONT_CONFIG_TYPE_FONT (font_config_font_get_type ())
#define FONT_CONFIG_FONT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_CONFIG_TYPE_FONT, FontConfigFont))
#define FONT_CONFIG_FONT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_CONFIG_TYPE_FONT, FontConfigFontClass))
#define FONT_CONFIG_IS_FONT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_CONFIG_TYPE_FONT))
#define FONT_CONFIG_IS_FONT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_CONFIG_TYPE_FONT))
#define FONT_CONFIG_FONT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_CONFIG_TYPE_FONT, FontConfigFontClass))

typedef struct _FontConfigFont FontConfigFont;
typedef struct _FontConfigFontClass FontConfigFontClass;

#define FONT_MANAGER_TYPE_FONT_INFO (font_manager_font_info_get_type ())
#define FONT_MANAGER_FONT_INFO(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_TYPE_FONT_INFO, FontManagerFontInfo))
#define FONT_MANAGER_FONT_INFO_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_TYPE_FONT_INFO, FontManagerFontInfoClass))
#define FONT_MANAGER_IS_FONT_INFO(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_TYPE_FONT_INFO))
#define FONT_MANAGER_IS_FONT_INFO_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_TYPE_FONT_INFO))
#define FONT_MANAGER_FONT_INFO_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_TYPE_FONT_INFO, FontManagerFontInfoClass))

typedef struct _FontManagerFontInfo FontManagerFontInfo;
typedef struct _FontManagerFontInfoClass FontManagerFontInfoClass;
typedef struct _FontManagerFontData FontManagerFontData;

#define FONT_MANAGER_METADATA_TYPE_TITLE (font_manager_metadata_title_get_type ())
#define FONT_MANAGER_METADATA_TITLE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_METADATA_TYPE_TITLE, FontManagerMetadataTitle))
#define FONT_MANAGER_METADATA_TITLE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_METADATA_TYPE_TITLE, FontManagerMetadataTitleClass))
#define FONT_MANAGER_METADATA_IS_TITLE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_METADATA_TYPE_TITLE))
#define FONT_MANAGER_METADATA_IS_TITLE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_METADATA_TYPE_TITLE))
#define FONT_MANAGER_METADATA_TITLE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_METADATA_TYPE_TITLE, FontManagerMetadataTitleClass))

typedef struct _FontManagerMetadataTitle FontManagerMetadataTitle;
typedef struct _FontManagerMetadataTitleClass FontManagerMetadataTitleClass;

#define FONT_MANAGER_METADATA_TYPE_PANE (font_manager_metadata_pane_get_type ())
#define FONT_MANAGER_METADATA_PANE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_METADATA_TYPE_PANE, FontManagerMetadataPane))
#define FONT_MANAGER_METADATA_PANE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_METADATA_TYPE_PANE, FontManagerMetadataPaneClass))
#define FONT_MANAGER_METADATA_IS_PANE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_METADATA_TYPE_PANE))
#define FONT_MANAGER_METADATA_IS_PANE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_METADATA_TYPE_PANE))
#define FONT_MANAGER_METADATA_PANE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_METADATA_TYPE_PANE, FontManagerMetadataPaneClass))

typedef struct _FontManagerMetadataPane FontManagerMetadataPane;
typedef struct _FontManagerMetadataPaneClass FontManagerMetadataPaneClass;

#define FONT_MANAGER_TYPE_ADJUSTABLE_PREVIEW (font_manager_adjustable_preview_get_type ())
#define FONT_MANAGER_ADJUSTABLE_PREVIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_TYPE_ADJUSTABLE_PREVIEW, FontManagerAdjustablePreview))
#define FONT_MANAGER_ADJUSTABLE_PREVIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_TYPE_ADJUSTABLE_PREVIEW, FontManagerAdjustablePreviewClass))
#define FONT_MANAGER_IS_ADJUSTABLE_PREVIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_TYPE_ADJUSTABLE_PREVIEW))
#define FONT_MANAGER_IS_ADJUSTABLE_PREVIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_TYPE_ADJUSTABLE_PREVIEW))
#define FONT_MANAGER_ADJUSTABLE_PREVIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_TYPE_ADJUSTABLE_PREVIEW, FontManagerAdjustablePreviewClass))

typedef struct _FontManagerAdjustablePreview FontManagerAdjustablePreview;
typedef struct _FontManagerAdjustablePreviewClass FontManagerAdjustablePreviewClass;

#define FONT_MANAGER_TYPE_ACTIVE_PREVIEW (font_manager_active_preview_get_type ())
#define FONT_MANAGER_ACTIVE_PREVIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_TYPE_ACTIVE_PREVIEW, FontManagerActivePreview))
#define FONT_MANAGER_ACTIVE_PREVIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_TYPE_ACTIVE_PREVIEW, FontManagerActivePreviewClass))
#define FONT_MANAGER_IS_ACTIVE_PREVIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_TYPE_ACTIVE_PREVIEW))
#define FONT_MANAGER_IS_ACTIVE_PREVIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_TYPE_ACTIVE_PREVIEW))
#define FONT_MANAGER_ACTIVE_PREVIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_TYPE_ACTIVE_PREVIEW, FontManagerActivePreviewClass))

typedef struct _FontManagerActivePreview FontManagerActivePreview;
typedef struct _FontManagerActivePreviewClass FontManagerActivePreviewClass;
#define _font_manager_font_data_free0(var) ((var == NULL) ? NULL : (var = (font_manager_font_data_free (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define FONT_MANAGER_TYPE_DRAG_TARGET_TYPE (font_manager_drag_target_type_get_type ())

#define FONT_MANAGER_TYPE_APPLICATION (font_manager_application_get_type ())
#define FONT_MANAGER_APPLICATION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_TYPE_APPLICATION, FontManagerApplication))
#define FONT_MANAGER_APPLICATION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_TYPE_APPLICATION, FontManagerApplicationClass))
#define FONT_MANAGER_IS_APPLICATION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_TYPE_APPLICATION))
#define FONT_MANAGER_IS_APPLICATION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_TYPE_APPLICATION))
#define FONT_MANAGER_APPLICATION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_TYPE_APPLICATION, FontManagerApplicationClass))

typedef struct _FontManagerApplication FontManagerApplication;
typedef struct _FontManagerApplicationClass FontManagerApplicationClass;

#define FONT_MANAGER_TYPE_STANDARD_TEXT_TAG_TABLE (font_manager_standard_text_tag_table_get_type ())
#define FONT_MANAGER_STANDARD_TEXT_TAG_TABLE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_MANAGER_TYPE_STANDARD_TEXT_TAG_TABLE, FontManagerStandardTextTagTable))
#define FONT_MANAGER_STANDARD_TEXT_TAG_TABLE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_MANAGER_TYPE_STANDARD_TEXT_TAG_TABLE, FontManagerStandardTextTagTableClass))
#define FONT_MANAGER_IS_STANDARD_TEXT_TAG_TABLE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_MANAGER_TYPE_STANDARD_TEXT_TAG_TABLE))
#define FONT_MANAGER_IS_STANDARD_TEXT_TAG_TABLE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_MANAGER_TYPE_STANDARD_TEXT_TAG_TABLE))
#define FONT_MANAGER_STANDARD_TEXT_TAG_TABLE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_MANAGER_TYPE_STANDARD_TEXT_TAG_TABLE, FontManagerStandardTextTagTableClass))

typedef struct _FontManagerStandardTextTagTable FontManagerStandardTextTagTable;
typedef struct _FontManagerStandardTextTagTableClass FontManagerStandardTextTagTableClass;
#define _g_free0(var) (var = (g_free (var), NULL))
#define __vala_PangoFontDescription_free0(var) ((var == NULL) ? NULL : (var = (_vala_PangoFontDescription_free (var), NULL)))

struct _FontManagerViewer {
	GtkWindow parent_instance;
	FontManagerViewerPrivate * priv;
};

struct _FontManagerViewerClass {
	GtkWindowClass parent_class;
};

struct _FontManagerFontData {
	GFile* file;
	FontConfigFont* font;
	FontManagerFontInfo* fontinfo;
};

struct _FontManagerViewerPrivate {
	FontManagerFontData* _fontdata;
	GtkBox* box;
	FontManagerMetadataPane* metadata;
	FontManagerActivePreview* preview;
	GtkApplication* _parent_;
	GtkButton* button;
	GeeArrayList* _installed;
};

typedef enum  {
	FONT_MANAGER_DRAG_TARGET_TYPE_FAMILY,
	FONT_MANAGER_DRAG_TARGET_TYPE_COLLECTION,
	FONT_MANAGER_DRAG_TARGET_TYPE_EXTERNAL
} FontManagerDragTargetType;


static gpointer font_manager_viewer_parent_class = NULL;

GType font_manager_viewer_get_type (void) G_GNUC_CONST;
guint font_manager_viewer_register_object (void* object, GDBusConnection* connection, const gchar* path, GError** error);
GType font_manager_font_data_get_type (void) G_GNUC_CONST;
GType cacheable_get_type (void) G_GNUC_CONST;
GType font_config_font_get_type (void) G_GNUC_CONST;
GType font_manager_font_info_get_type (void) G_GNUC_CONST;
FontManagerFontData* font_manager_font_data_dup (const FontManagerFontData* self);
void font_manager_font_data_free (FontManagerFontData* self);
void font_manager_font_data_copy (const FontManagerFontData* self, FontManagerFontData* dest);
void font_manager_font_data_destroy (FontManagerFontData* self);
GType font_manager_metadata_title_get_type (void) G_GNUC_CONST;
GType font_manager_metadata_pane_get_type (void) G_GNUC_CONST;
GType font_manager_adjustable_preview_get_type (void) G_GNUC_CONST;
GType font_manager_active_preview_get_type (void) G_GNUC_CONST;
#define FONT_MANAGER_VIEWER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), FONT_MANAGER_TYPE_VIEWER, FontManagerViewerPrivate))
enum  {
	FONT_MANAGER_VIEWER_DUMMY_PROPERTY
};
FontManagerViewer* font_manager_viewer_new (void);
FontManagerViewer* font_manager_viewer_construct (GType object_type);
GType font_manager_drag_target_type_get_type (void) G_GNUC_CONST;
#define FONT_MANAGER_AppDragActions GDK_ACTION_COPY
GType font_manager_application_get_type (void) G_GNUC_CONST;
guint font_manager_application_register_object (void* object, GDBusConnection* connection, const gchar* path, GError** error);
#define FONT_MANAGER_ABOUT_ICON "font-x-generic"
FontManagerMetadataPane* font_manager_metadata_pane_new (void);
FontManagerMetadataPane* font_manager_metadata_pane_construct (GType object_type);
GtkSeparator* add_separator (GtkBox* box, GtkOrientation orientation, GtkPackType pack_type);
FontManagerStandardTextTagTable* font_manager_standard_text_tag_table_new (void);
FontManagerStandardTextTagTable* font_manager_standard_text_tag_table_construct (GType object_type);
GType font_manager_standard_text_tag_table_get_type (void) G_GNUC_CONST;
FontManagerActivePreview* font_manager_active_preview_new (FontManagerStandardTextTagTable* tag_table);
FontManagerActivePreview* font_manager_active_preview_construct (GType object_type, FontManagerStandardTextTagTable* tag_table);
GtkNotebook* font_manager_metadata_pane_get_notebook (FontManagerMetadataPane* self);
static void __lambda130_ (FontManagerViewer* self);
gboolean font_manager_library_install_install_font (FontManagerFontData* data);
FontManagerFontData* font_manager_viewer_get_fontdata (FontManagerViewer* self);
const gchar* font_manager_font_info_get_checksum (FontManagerFontInfo* self);
static void font_manager_viewer_update_button_state (FontManagerViewer* self);
static void ___lambda130__gtk_button_clicked (GtkButton* _sender, gpointer self);
void font_manager_viewer_show_uri (FontManagerViewer* self, const gchar* uri);
void font_manager_font_data_init (FontManagerFontData *self, GFile* file, const gchar* rmdir);
void font_manager_viewer_set_fontdata (FontManagerViewer* self, FontManagerFontData* value);
gboolean font_manager_viewer_ready (FontManagerViewer* self);
static void font_manager_viewer_real_show (GtkWidget* base);
static gboolean font_manager_viewer_real_delete_event (GtkWidget* base, GdkEventAny* event);
void font_manager_viewer_quit (FontManagerViewer* self);
void font_manager_viewer_update (FontManagerViewer* self);
gboolean font_config_add_app_font (const gchar* filepath);
static gboolean ___lambda131_ (FontManagerViewer* self);
void font_manager_metadata_title_update (FontManagerMetadataTitle* self, FontManagerFontData* fontdata);
const gchar* font_config_font_get_description (FontConfigFont* self);
void font_manager_active_preview_set_font_desc (FontManagerActivePreview* self, PangoFontDescription* value);
static void _vala_PangoFontDescription_free (PangoFontDescription* self);
static gboolean ____lambda131__gsource_func (gpointer self);
#define FONT_MANAGER_DEFAULT_FONT "Sans"
static void font_manager_viewer_real_drag_data_received (GtkWidget* base, GdkDragContext* context, gint x, gint y, GtkSelectionData* selection_data, guint info, guint time);
void font_config_clear_app_fonts (void);
gboolean font_manager_library_is_installed (FontManagerFontData* fontdata);
gint font_manager_library_conflicts (FontManagerFontData* fontdata);
static void font_manager_viewer_finalize (GObject* obj);
static void _vala_font_manager_viewer_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_font_manager_viewer_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);
static void _dbus_font_manager_viewer_show_uri (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void _dbus_font_manager_viewer_ready (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void _dbus_font_manager_viewer_quit (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void _dbus_font_manager_viewer_update (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void font_manager_viewer_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data);
static GVariant* font_manager_viewer_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data);
static gboolean font_manager_viewer_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data);
static void _font_manager_viewer_unregister_object (gpointer user_data);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);

extern const GtkTargetEntry FONT_MANAGER_AppDragTargets[2];
static const GDBusArgInfo _font_manager_viewer_dbus_arg_info_show_uri_uri = {-1, "uri", "s"};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_show_uri_in[] = {&_font_manager_viewer_dbus_arg_info_show_uri_uri, NULL};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_show_uri_out[] = {NULL};
static const GDBusMethodInfo _font_manager_viewer_dbus_method_info_show_uri = {-1, "ShowUri", (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_show_uri_in), (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_show_uri_out)};
static const GDBusArgInfo _font_manager_viewer_dbus_arg_info_ready_result = {-1, "result", "b"};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_ready_in[] = {NULL};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_ready_out[] = {&_font_manager_viewer_dbus_arg_info_ready_result, NULL};
static const GDBusMethodInfo _font_manager_viewer_dbus_method_info_ready = {-1, "Ready", (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_ready_in), (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_ready_out)};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_quit_in[] = {NULL};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_quit_out[] = {NULL};
static const GDBusMethodInfo _font_manager_viewer_dbus_method_info_quit = {-1, "Quit", (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_quit_in), (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_quit_out)};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_update_in[] = {NULL};
static const GDBusArgInfo * const _font_manager_viewer_dbus_arg_info_update_out[] = {NULL};
static const GDBusMethodInfo _font_manager_viewer_dbus_method_info_update = {-1, "Update", (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_update_in), (GDBusArgInfo **) (&_font_manager_viewer_dbus_arg_info_update_out)};
static const GDBusMethodInfo * const _font_manager_viewer_dbus_method_info[] = {&_font_manager_viewer_dbus_method_info_show_uri, &_font_manager_viewer_dbus_method_info_ready, &_font_manager_viewer_dbus_method_info_quit, &_font_manager_viewer_dbus_method_info_update, NULL};
static const GDBusSignalInfo * const _font_manager_viewer_dbus_signal_info[] = {NULL};
static const GDBusPropertyInfo * const _font_manager_viewer_dbus_property_info[] = {NULL};
static const GDBusInterfaceInfo _font_manager_viewer_dbus_interface_info = {-1, "org.gnome.FontManager.FontViewer", (GDBusMethodInfo **) (&_font_manager_viewer_dbus_method_info), (GDBusSignalInfo **) (&_font_manager_viewer_dbus_signal_info), (GDBusPropertyInfo **) (&_font_manager_viewer_dbus_property_info)};
static const GDBusInterfaceVTable _font_manager_viewer_dbus_interface_vtable = {font_manager_viewer_dbus_interface_method_call, font_manager_viewer_dbus_interface_get_property, font_manager_viewer_dbus_interface_set_property};

static void __lambda130_ (FontManagerViewer* self) {
	FontManagerFontData* _tmp0_ = NULL;
	FontManagerFontData* _tmp1_ = NULL;
	FontManagerFontData _tmp2_ = {0};
	gboolean _tmp3_ = FALSE;
	_tmp0_ = font_manager_viewer_get_fontdata (self);
	_tmp1_ = _tmp0_;
	_tmp2_ = *_tmp1_;
	_tmp3_ = font_manager_library_install_install_font (&_tmp2_);
	if (_tmp3_) {
		GeeArrayList* _tmp4_ = NULL;
		FontManagerFontData* _tmp5_ = NULL;
		FontManagerFontData* _tmp6_ = NULL;
		FontManagerFontInfo* _tmp7_ = NULL;
		const gchar* _tmp8_ = NULL;
		const gchar* _tmp9_ = NULL;
		_tmp4_ = self->priv->_installed;
		_tmp5_ = font_manager_viewer_get_fontdata (self);
		_tmp6_ = _tmp5_;
		_tmp7_ = (*_tmp6_).fontinfo;
		_tmp8_ = font_manager_font_info_get_checksum (_tmp7_);
		_tmp9_ = _tmp8_;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp4_, _tmp9_);
	}
	font_manager_viewer_update_button_state (self);
}


static void ___lambda130__gtk_button_clicked (GtkButton* _sender, gpointer self) {
	__lambda130_ ((FontManagerViewer*) self);
}


FontManagerViewer* font_manager_viewer_construct (GType object_type) {
	FontManagerViewer * self = NULL;
	GApplication* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	GeeArrayList* _tmp2_ = NULL;
	FontManagerMetadataPane* _tmp3_ = NULL;
	GtkBox* _tmp4_ = NULL;
	GtkBox* _tmp5_ = NULL;
	GtkSeparator* _tmp6_ = NULL;
	GtkSeparator* _tmp7_ = NULL;
	GtkBox* _tmp8_ = NULL;
	FontManagerMetadataPane* _tmp9_ = NULL;
	FontManagerStandardTextTagTable* _tmp10_ = NULL;
	FontManagerStandardTextTagTable* _tmp11_ = NULL;
	FontManagerActivePreview* _tmp12_ = NULL;
	FontManagerActivePreview* _tmp13_ = NULL;
	FontManagerMetadataPane* _tmp14_ = NULL;
	GtkNotebook* _tmp15_ = NULL;
	GtkNotebook* _tmp16_ = NULL;
	FontManagerActivePreview* _tmp17_ = NULL;
	const gchar* _tmp18_ = NULL;
	GtkLabel* _tmp19_ = NULL;
	GtkLabel* _tmp20_ = NULL;
	GtkButton* _tmp21_ = NULL;
	GtkButton* _tmp22_ = NULL;
	const gchar* _tmp23_ = NULL;
	GtkButton* _tmp24_ = NULL;
	GtkButton* _tmp25_ = NULL;
	GtkButton* _tmp26_ = NULL;
	FontManagerMetadataPane* _tmp27_ = NULL;
	GtkNotebook* _tmp28_ = NULL;
	GtkNotebook* _tmp29_ = NULL;
	GtkButton* _tmp30_ = NULL;
	GtkBox* _tmp31_ = NULL;
	self = (FontManagerViewer*) g_object_new (object_type, NULL);
	gtk_drag_dest_set ((GtkWidget*) self, GTK_DEST_DEFAULT_ALL, FONT_MANAGER_AppDragTargets, G_N_ELEMENTS (FONT_MANAGER_AppDragTargets), FONT_MANAGER_AppDragActions);
	_tmp0_ = g_application_get_default ();
	self->priv->_parent_ = (GtkApplication*) G_TYPE_CHECK_INSTANCE_CAST (_tmp0_, FONT_MANAGER_TYPE_APPLICATION, FontManagerApplication);
	_tmp1_ = _ ("Font Viewer");
	gtk_window_set_title ((GtkWindow*) self, _tmp1_);
	gtk_window_set_icon_name ((GtkWindow*) self, FONT_MANAGER_ABOUT_ICON);
	_tmp2_ = gee_array_list_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL);
	_g_object_unref0 (self->priv->_installed);
	self->priv->_installed = _tmp2_;
	_tmp3_ = font_manager_metadata_pane_new ();
	g_object_ref_sink (_tmp3_);
	_g_object_unref0 (self->priv->metadata);
	self->priv->metadata = _tmp3_;
	_tmp4_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_VERTICAL, 0);
	g_object_ref_sink (_tmp4_);
	_g_object_unref0 (self->priv->box);
	self->priv->box = _tmp4_;
	_tmp5_ = self->priv->box;
	_tmp6_ = add_separator (_tmp5_, GTK_ORIENTATION_HORIZONTAL, GTK_PACK_START);
	_tmp7_ = _tmp6_;
	_g_object_unref0 (_tmp7_);
	_tmp8_ = self->priv->box;
	_tmp9_ = self->priv->metadata;
	gtk_box_pack_end (_tmp8_, (GtkWidget*) _tmp9_, TRUE, TRUE, (guint) 0);
	_tmp10_ = font_manager_standard_text_tag_table_new ();
	_tmp11_ = _tmp10_;
	_tmp12_ = font_manager_active_preview_new (_tmp11_);
	g_object_ref_sink (_tmp12_);
	_g_object_unref0 (self->priv->preview);
	self->priv->preview = _tmp12_;
	_g_object_unref0 (_tmp11_);
	_tmp13_ = self->priv->preview;
	gtk_widget_set_margin_top ((GtkWidget*) _tmp13_, 4);
	_tmp14_ = self->priv->metadata;
	_tmp15_ = font_manager_metadata_pane_get_notebook (_tmp14_);
	_tmp16_ = _tmp15_;
	_tmp17_ = self->priv->preview;
	_tmp18_ = _ ("Preview");
	_tmp19_ = (GtkLabel*) gtk_label_new (_tmp18_);
	g_object_ref_sink (_tmp19_);
	_tmp20_ = _tmp19_;
	gtk_notebook_insert_page (_tmp16_, (GtkWidget*) _tmp17_, (GtkWidget*) _tmp20_, 0);
	_g_object_unref0 (_tmp20_);
	_tmp21_ = (GtkButton*) gtk_button_new ();
	g_object_ref_sink (_tmp21_);
	_g_object_unref0 (self->priv->button);
	self->priv->button = _tmp21_;
	_tmp22_ = self->priv->button;
	_tmp23_ = _ ("Install Font");
	gtk_button_set_label (_tmp22_, _tmp23_);
	_tmp24_ = self->priv->button;
	g_object_set ((GtkWidget*) _tmp24_, "margin", 2, NULL);
	_tmp25_ = self->priv->button;
	gtk_widget_set_opacity ((GtkWidget*) _tmp25_, 0.725);
	_tmp26_ = self->priv->button;
	g_signal_connect_object (_tmp26_, "clicked", (GCallback) ___lambda130__gtk_button_clicked, self, 0);
	font_manager_viewer_update_button_state (self);
	_tmp27_ = self->priv->metadata;
	_tmp28_ = font_manager_metadata_pane_get_notebook (_tmp27_);
	_tmp29_ = _tmp28_;
	_tmp30_ = self->priv->button;
	gtk_notebook_set_action_widget (_tmp29_, (GtkWidget*) _tmp30_, GTK_PACK_END);
	_tmp31_ = self->priv->box;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp31_);
	gtk_window_set_default_size ((GtkWindow*) self, 600, 400);
	return self;
}


FontManagerViewer* font_manager_viewer_new (void) {
	return font_manager_viewer_construct (FONT_MANAGER_TYPE_VIEWER);
}


void font_manager_viewer_show_uri (FontManagerViewer* self, const gchar* uri) {
	GFile* file = NULL;
	const gchar* _tmp0_ = NULL;
	GFile* _tmp1_ = NULL;
	GFile* _tmp2_ = NULL;
	gboolean _tmp3_ = FALSE;
	g_return_if_fail (self != NULL);
	g_return_if_fail (uri != NULL);
	_tmp0_ = uri;
	_tmp1_ = g_file_new_for_uri (_tmp0_);
	file = _tmp1_;
	_tmp2_ = file;
	_tmp3_ = g_file_query_exists (_tmp2_, NULL);
	if (_tmp3_) {
		GFile* _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		gchar* _tmp6_ = NULL;
		GFile* _tmp7_ = NULL;
		FontManagerFontData _tmp8_ = {0};
		FontManagerFontData _tmp9_ = {0};
		FontManagerFontData _tmp10_ = {0};
		_tmp4_ = file;
		_tmp5_ = g_file_get_path (_tmp4_);
		_tmp6_ = _tmp5_;
		g_debug ("Viewer.vala:79: Opening %s for preview.", _tmp6_);
		_g_free0 (_tmp6_);
		_tmp7_ = file;
		font_manager_font_data_init (&_tmp8_, _tmp7_, NULL);
		_tmp9_ = _tmp8_;
		_tmp10_ = _tmp9_;
		font_manager_viewer_set_fontdata (self, &_tmp10_);
		font_manager_font_data_destroy (&_tmp9_);
	}
	_g_object_unref0 (file);
	return;
}


gboolean font_manager_viewer_ready (FontManagerViewer* self) {
	gboolean result = FALSE;
	gboolean _tmp0_ = FALSE;
	gboolean _tmp1_ = FALSE;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = gtk_widget_get_visible ((GtkWidget*) self);
	_tmp1_ = _tmp0_;
	result = _tmp1_;
	return result;
}


static void font_manager_viewer_real_show (GtkWidget* base) {
	FontManagerViewer * self;
	GtkButton* _tmp0_ = NULL;
	FontManagerMetadataPane* _tmp1_ = NULL;
	FontManagerActivePreview* _tmp2_ = NULL;
	GtkBox* _tmp3_ = NULL;
	GtkApplication* _tmp4_ = NULL;
	self = (FontManagerViewer*) base;
	_tmp0_ = self->priv->button;
	gtk_widget_show ((GtkWidget*) _tmp0_);
	_tmp1_ = self->priv->metadata;
	gtk_widget_show ((GtkWidget*) _tmp1_);
	_tmp2_ = self->priv->preview;
	gtk_widget_show ((GtkWidget*) _tmp2_);
	_tmp3_ = self->priv->box;
	gtk_widget_show ((GtkWidget*) _tmp3_);
	_tmp4_ = self->priv->_parent_;
	gtk_application_add_window (_tmp4_, (GtkWindow*) self);
	GTK_WIDGET_CLASS (font_manager_viewer_parent_class)->show ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_window_get_type (), GtkWindow));
	return;
}


static gboolean font_manager_viewer_real_delete_event (GtkWidget* base, GdkEventAny* event) {
	FontManagerViewer * self;
	gboolean result = FALSE;
	GtkApplication* _tmp0_ = NULL;
	GList* _tmp1_ = NULL;
	guint _tmp2_ = 0U;
	gboolean _tmp3_ = FALSE;
	self = (FontManagerViewer*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = self->priv->_parent_;
	_tmp1_ = gtk_application_get_windows (_tmp0_);
	_tmp2_ = g_list_length (_tmp1_);
	if (_tmp2_ == ((guint) 1)) {
		font_manager_viewer_quit (self);
	}
	_tmp3_ = gtk_widget_hide_on_delete ((GtkWidget*) self);
	result = _tmp3_;
	return result;
}


void font_manager_viewer_quit (FontManagerViewer* self) {
	GtkApplication* _tmp0_ = NULL;
	g_return_if_fail (self != NULL);
	gtk_widget_hide ((GtkWidget*) self);
	_tmp0_ = self->priv->_parent_;
	gtk_application_remove_window (_tmp0_, (GtkWindow*) self);
	return;
}


static void _vala_PangoFontDescription_free (PangoFontDescription* self) {
	g_boxed_free (pango_font_description_get_type (), self);
}


static gboolean ___lambda131_ (FontManagerViewer* self) {
	gboolean result = FALSE;
	FontManagerMetadataPane* _tmp0_ = NULL;
	FontManagerFontData* _tmp1_ = NULL;
	FontManagerFontData* _tmp2_ = NULL;
	FontManagerActivePreview* _tmp3_ = NULL;
	FontManagerFontData* _tmp4_ = NULL;
	FontManagerFontData* _tmp5_ = NULL;
	FontConfigFont* _tmp6_ = NULL;
	const gchar* _tmp7_ = NULL;
	const gchar* _tmp8_ = NULL;
	PangoFontDescription* _tmp9_ = NULL;
	PangoFontDescription* _tmp10_ = NULL;
	_tmp0_ = self->priv->metadata;
	_tmp1_ = font_manager_viewer_get_fontdata (self);
	_tmp2_ = _tmp1_;
	font_manager_metadata_title_update ((FontManagerMetadataTitle*) _tmp0_, _tmp2_);
	_tmp3_ = self->priv->preview;
	_tmp4_ = font_manager_viewer_get_fontdata (self);
	_tmp5_ = _tmp4_;
	_tmp6_ = (*_tmp5_).font;
	_tmp7_ = font_config_font_get_description (_tmp6_);
	_tmp8_ = _tmp7_;
	_tmp9_ = pango_font_description_from_string (_tmp8_);
	_tmp10_ = _tmp9_;
	font_manager_active_preview_set_font_desc (_tmp3_, _tmp10_);
	__vala_PangoFontDescription_free0 (_tmp10_);
	result = FALSE;
	return result;
}


static gboolean ____lambda131__gsource_func (gpointer self) {
	gboolean result;
	result = ___lambda131_ ((FontManagerViewer*) self);
	return result;
}


void font_manager_viewer_update (FontManagerViewer* self) {
	FontManagerFontData* _tmp0_ = NULL;
	FontManagerFontData* _tmp1_ = NULL;
	g_return_if_fail (self != NULL);
	font_manager_viewer_update_button_state (self);
	_tmp0_ = font_manager_viewer_get_fontdata (self);
	_tmp1_ = _tmp0_;
	if (_tmp1_ != NULL) {
		FontManagerFontData* _tmp2_ = NULL;
		FontManagerFontData* _tmp3_ = NULL;
		GFile* _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		gchar* _tmp6_ = NULL;
		_tmp2_ = font_manager_viewer_get_fontdata (self);
		_tmp3_ = _tmp2_;
		_tmp4_ = (*_tmp3_).file;
		_tmp5_ = g_file_get_path (_tmp4_);
		_tmp6_ = _tmp5_;
		font_config_add_app_font (_tmp6_);
		_g_free0 (_tmp6_);
		g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ____lambda131__gsource_func, g_object_ref (self), g_object_unref);
	} else {
		FontManagerMetadataPane* _tmp7_ = NULL;
		FontManagerActivePreview* _tmp8_ = NULL;
		PangoFontDescription* _tmp9_ = NULL;
		PangoFontDescription* _tmp10_ = NULL;
		_tmp7_ = self->priv->metadata;
		font_manager_metadata_title_update ((FontManagerMetadataTitle*) _tmp7_, NULL);
		_tmp8_ = self->priv->preview;
		_tmp9_ = pango_font_description_from_string (FONT_MANAGER_DEFAULT_FONT);
		_tmp10_ = _tmp9_;
		font_manager_active_preview_set_font_desc (_tmp8_, _tmp10_);
		__vala_PangoFontDescription_free0 (_tmp10_);
	}
	return;
}


static void font_manager_viewer_real_drag_data_received (GtkWidget* base, GdkDragContext* context, gint x, gint y, GtkSelectionData* selection_data, guint info, guint time) {
	FontManagerViewer * self;
	guint _tmp0_ = 0U;
	self = (FontManagerViewer*) base;
	g_return_if_fail (context != NULL);
	g_return_if_fail (selection_data != NULL);
	_tmp0_ = info;
	switch (_tmp0_) {
		case FONT_MANAGER_DRAG_TARGET_TYPE_EXTERNAL:
		{
			GtkSelectionData* _tmp1_ = NULL;
			gchar** _tmp2_ = NULL;
			gchar** _tmp3_ = NULL;
			gchar** _tmp4_ = NULL;
			gint _tmp4__length1 = 0;
			const gchar* _tmp5_ = NULL;
			_tmp1_ = selection_data;
			_tmp3_ = _tmp2_ = gtk_selection_data_get_uris (_tmp1_);
			_tmp4_ = _tmp3_;
			_tmp4__length1 = _vala_array_length (_tmp2_);
			_tmp5_ = _tmp4_[0];
			font_manager_viewer_show_uri (self, _tmp5_);
			_tmp4_ = (_vala_array_free (_tmp4_, _tmp4__length1, (GDestroyNotify) g_free), NULL);
			break;
		}
		default:
		{
			g_warning ("Viewer.vala:140: Unsupported drag target.");
			return;
		}
	}
	return;
}


static void font_manager_viewer_update_button_state (FontManagerViewer* self) {
	FontManagerFontData* _tmp0_ = NULL;
	FontManagerFontData* _tmp1_ = NULL;
	gboolean installed = FALSE;
	FontManagerFontData* _tmp4_ = NULL;
	FontManagerFontData* _tmp5_ = NULL;
	FontManagerFontData _tmp6_ = {0};
	gboolean _tmp7_ = FALSE;
	GeeArrayList* _tmp8_ = NULL;
	FontManagerFontData* _tmp9_ = NULL;
	FontManagerFontData* _tmp10_ = NULL;
	FontManagerFontInfo* _tmp11_ = NULL;
	const gchar* _tmp12_ = NULL;
	const gchar* _tmp13_ = NULL;
	gboolean _tmp14_ = FALSE;
	FontManagerFontData* _tmp15_ = NULL;
	FontManagerFontData* _tmp16_ = NULL;
	FontManagerFontData _tmp17_ = {0};
	gint _tmp18_ = 0;
	g_return_if_fail (self != NULL);
	_tmp0_ = font_manager_viewer_get_fontdata (self);
	_tmp1_ = _tmp0_;
	if (_tmp1_ == NULL) {
		GtkButton* _tmp2_ = NULL;
		_tmp2_ = self->priv->button;
		gtk_widget_hide ((GtkWidget*) _tmp2_);
		return;
	} else {
		GtkButton* _tmp3_ = NULL;
		_tmp3_ = self->priv->button;
		gtk_widget_show ((GtkWidget*) _tmp3_);
	}
	font_config_clear_app_fonts ();
	_tmp4_ = font_manager_viewer_get_fontdata (self);
	_tmp5_ = _tmp4_;
	_tmp6_ = *_tmp5_;
	_tmp7_ = font_manager_library_is_installed (&_tmp6_);
	installed = _tmp7_;
	_tmp8_ = self->priv->_installed;
	_tmp9_ = font_manager_viewer_get_fontdata (self);
	_tmp10_ = _tmp9_;
	_tmp11_ = (*_tmp10_).fontinfo;
	_tmp12_ = font_manager_font_info_get_checksum (_tmp11_);
	_tmp13_ = _tmp12_;
	_tmp14_ = gee_abstract_collection_contains ((GeeAbstractCollection*) _tmp8_, _tmp13_);
	if (_tmp14_) {
		installed = TRUE;
	}
	_tmp15_ = font_manager_viewer_get_fontdata (self);
	_tmp16_ = _tmp15_;
	_tmp17_ = *_tmp16_;
	_tmp18_ = font_manager_library_conflicts (&_tmp17_);
	if (_tmp18_ > 0) {
		GtkButton* _tmp19_ = NULL;
		const gchar* _tmp20_ = NULL;
		GtkButton* _tmp21_ = NULL;
		GtkButton* _tmp22_ = NULL;
		_tmp19_ = self->priv->button;
		_tmp20_ = _ ("Newer version already installed");
		gtk_button_set_label (_tmp19_, _tmp20_);
		_tmp21_ = self->priv->button;
		gtk_widget_set_sensitive ((GtkWidget*) _tmp21_, FALSE);
		_tmp22_ = self->priv->button;
		gtk_button_set_relief (_tmp22_, GTK_RELIEF_NONE);
		return;
	} else {
		gboolean _tmp23_ = FALSE;
		_tmp23_ = installed;
		if (_tmp23_) {
			GtkButton* _tmp24_ = NULL;
			const gchar* _tmp25_ = NULL;
			GtkButton* _tmp26_ = NULL;
			GtkButton* _tmp27_ = NULL;
			_tmp24_ = self->priv->button;
			_tmp25_ = _ ("Installed");
			gtk_button_set_label (_tmp24_, _tmp25_);
			_tmp26_ = self->priv->button;
			gtk_widget_set_sensitive ((GtkWidget*) _tmp26_, FALSE);
			_tmp27_ = self->priv->button;
			gtk_button_set_relief (_tmp27_, GTK_RELIEF_NONE);
		} else {
			GtkButton* _tmp28_ = NULL;
			const gchar* _tmp29_ = NULL;
			GtkButton* _tmp30_ = NULL;
			GtkButton* _tmp31_ = NULL;
			_tmp28_ = self->priv->button;
			_tmp29_ = _ ("Install Font");
			gtk_button_set_label (_tmp28_, _tmp29_);
			_tmp30_ = self->priv->button;
			gtk_widget_set_sensitive ((GtkWidget*) _tmp30_, TRUE);
			_tmp31_ = self->priv->button;
			gtk_button_set_relief (_tmp31_, GTK_RELIEF_NORMAL);
		}
	}
	return;
}


FontManagerFontData* font_manager_viewer_get_fontdata (FontManagerViewer* self) {
	FontManagerFontData* result;
	FontManagerFontData* _tmp0_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_fontdata;
	result = _tmp0_;
	return result;
}


static gpointer _font_manager_font_data_dup0 (gpointer self) {
	return self ? font_manager_font_data_dup (self) : NULL;
}


void font_manager_viewer_set_fontdata (FontManagerViewer* self, FontManagerFontData* value) {
	FontManagerFontData* _tmp0_ = NULL;
	FontManagerFontData* _tmp1_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_tmp1_ = _font_manager_font_data_dup0 (_tmp0_);
	_font_manager_font_data_free0 (self->priv->_fontdata);
	self->priv->_fontdata = _tmp1_;
	font_manager_viewer_update (self);
}


static void font_manager_viewer_class_init (FontManagerViewerClass * klass) {
	font_manager_viewer_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (FontManagerViewerPrivate));
	((GtkWidgetClass *) klass)->show = font_manager_viewer_real_show;
	((GtkWidgetClass *) klass)->delete_event = font_manager_viewer_real_delete_event;
	((GtkWidgetClass *) klass)->drag_data_received = font_manager_viewer_real_drag_data_received;
	G_OBJECT_CLASS (klass)->get_property = _vala_font_manager_viewer_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_font_manager_viewer_set_property;
	G_OBJECT_CLASS (klass)->finalize = font_manager_viewer_finalize;
}


static void font_manager_viewer_instance_init (FontManagerViewer * self) {
	self->priv = FONT_MANAGER_VIEWER_GET_PRIVATE (self);
	self->priv->_fontdata = NULL;
}


static void font_manager_viewer_finalize (GObject* obj) {
	FontManagerViewer * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, FONT_MANAGER_TYPE_VIEWER, FontManagerViewer);
	_font_manager_font_data_free0 (self->priv->_fontdata);
	_g_object_unref0 (self->priv->box);
	_g_object_unref0 (self->priv->metadata);
	_g_object_unref0 (self->priv->preview);
	_g_object_unref0 (self->priv->button);
	_g_object_unref0 (self->priv->_installed);
	G_OBJECT_CLASS (font_manager_viewer_parent_class)->finalize (obj);
}


GType font_manager_viewer_get_type (void) {
	static volatile gsize font_manager_viewer_type_id__volatile = 0;
	if (g_once_init_enter (&font_manager_viewer_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (FontManagerViewerClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) font_manager_viewer_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (FontManagerViewer), 0, (GInstanceInitFunc) font_manager_viewer_instance_init, NULL };
		GType font_manager_viewer_type_id;
		font_manager_viewer_type_id = g_type_register_static (gtk_window_get_type (), "FontManagerViewer", &g_define_type_info, 0);
		g_type_set_qdata (font_manager_viewer_type_id, g_quark_from_static_string ("vala-dbus-register-object"), (void*) font_manager_viewer_register_object);
		g_once_init_leave (&font_manager_viewer_type_id__volatile, font_manager_viewer_type_id);
	}
	return font_manager_viewer_type_id__volatile;
}


static void _vala_font_manager_viewer_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	FontManagerViewer * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, FONT_MANAGER_TYPE_VIEWER, FontManagerViewer);
	switch (property_id) {
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_font_manager_viewer_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	FontManagerViewer * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, FONT_MANAGER_TYPE_VIEWER, FontManagerViewer);
	switch (property_id) {
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _dbus_font_manager_viewer_show_uri (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gchar* uri = NULL;
	GVariant* _tmp41_;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	_tmp41_ = g_variant_iter_next_value (&_arguments_iter);
	uri = g_variant_dup_string (_tmp41_, NULL);
	g_variant_unref (_tmp41_);
	font_manager_viewer_show_uri (self, uri);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	_g_free0 (uri);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void _dbus_font_manager_viewer_ready (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gboolean result;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	result = font_manager_viewer_ready (self);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (result));
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void _dbus_font_manager_viewer_quit (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	font_manager_viewer_quit (self);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void _dbus_font_manager_viewer_update (FontManagerViewer* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	font_manager_viewer_update (self);
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}


static void font_manager_viewer_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	if (strcmp (method_name, "ShowUri") == 0) {
		_dbus_font_manager_viewer_show_uri (object, parameters, invocation);
	} else if (strcmp (method_name, "Ready") == 0) {
		_dbus_font_manager_viewer_ready (object, parameters, invocation);
	} else if (strcmp (method_name, "Quit") == 0) {
		_dbus_font_manager_viewer_quit (object, parameters, invocation);
	} else if (strcmp (method_name, "Update") == 0) {
		_dbus_font_manager_viewer_update (object, parameters, invocation);
	} else {
		g_object_unref (invocation);
	}
}


static GVariant* font_manager_viewer_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	return NULL;
}


static gboolean font_manager_viewer_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	return FALSE;
}


guint font_manager_viewer_register_object (gpointer object, GDBusConnection* connection, const gchar* path, GError** error) {
	guint result;
	gpointer *data;
	data = g_new (gpointer, 3);
	data[0] = g_object_ref (object);
	data[1] = g_object_ref (connection);
	data[2] = g_strdup (path);
	result = g_dbus_connection_register_object (connection, path, (GDBusInterfaceInfo *) (&_font_manager_viewer_dbus_interface_info), &_font_manager_viewer_dbus_interface_vtable, data, _font_manager_viewer_unregister_object, error);
	if (!result) {
		return 0;
	}
	return result;
}


static void _font_manager_viewer_unregister_object (gpointer user_data) {
	gpointer* data;
	data = user_data;
	g_object_unref (data[0]);
	g_object_unref (data[1]);
	g_free (data[2]);
	g_free (data);
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



