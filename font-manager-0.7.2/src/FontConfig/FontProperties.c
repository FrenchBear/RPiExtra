/* FontProperties.c generated by valac 0.26.1, the Vala compiler
 * generated from FontProperties.vala, do not modify */

/* FontProperties.vala
 *
 * Copyright (C) 2009 - 2015 Jerry Casiano
 *
 * This file is part of Font Manager.
 *
 * Font Manager is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Font Manager is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Font Manager.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Author:
 *        Jerry Casiano <JerryCasiano@gmail.com>
*/

#include <glib.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <libxml/tree.h>
#include <libxml/xmlwriter.h>
#include <gee.h>
#include <float.h>
#include <math.h>


#define FONT_CONFIG_TYPE_PROPERTIES (font_config_properties_get_type ())
#define FONT_CONFIG_PROPERTIES(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_CONFIG_TYPE_PROPERTIES, FontConfigProperties))
#define FONT_CONFIG_PROPERTIES_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_CONFIG_TYPE_PROPERTIES, FontConfigPropertiesClass))
#define FONT_CONFIG_IS_PROPERTIES(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_CONFIG_TYPE_PROPERTIES))
#define FONT_CONFIG_IS_PROPERTIES_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_CONFIG_TYPE_PROPERTIES))
#define FONT_CONFIG_PROPERTIES_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_CONFIG_TYPE_PROPERTIES, FontConfigPropertiesClass))

typedef struct _FontConfigProperties FontConfigProperties;
typedef struct _FontConfigPropertiesClass FontConfigPropertiesClass;
typedef struct _FontConfigPropertiesPrivate FontConfigPropertiesPrivate;
typedef xmlTextWriter FontConfigXmlWriter;

#define FONT_CONFIG_TYPE_DEFAULT_PROPERTIES (font_config_default_properties_get_type ())
#define FONT_CONFIG_DEFAULT_PROPERTIES(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultProperties))
#define FONT_CONFIG_DEFAULT_PROPERTIES_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultPropertiesClass))
#define FONT_CONFIG_IS_DEFAULT_PROPERTIES(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_CONFIG_TYPE_DEFAULT_PROPERTIES))
#define FONT_CONFIG_IS_DEFAULT_PROPERTIES_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_CONFIG_TYPE_DEFAULT_PROPERTIES))
#define FONT_CONFIG_DEFAULT_PROPERTIES_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultPropertiesClass))

typedef struct _FontConfigDefaultProperties FontConfigDefaultProperties;
typedef struct _FontConfigDefaultPropertiesClass FontConfigDefaultPropertiesClass;
typedef struct _FontConfigDefaultPropertiesPrivate FontConfigDefaultPropertiesPrivate;

#define FONT_CONFIG_TYPE_FONT_PROPERTIES (font_config_font_properties_get_type ())
#define FONT_CONFIG_FONT_PROPERTIES(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_CONFIG_TYPE_FONT_PROPERTIES, FontConfigFontProperties))
#define FONT_CONFIG_FONT_PROPERTIES_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_CONFIG_TYPE_FONT_PROPERTIES, FontConfigFontPropertiesClass))
#define FONT_CONFIG_IS_FONT_PROPERTIES(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_CONFIG_TYPE_FONT_PROPERTIES))
#define FONT_CONFIG_IS_FONT_PROPERTIES_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_CONFIG_TYPE_FONT_PROPERTIES))
#define FONT_CONFIG_FONT_PROPERTIES_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_CONFIG_TYPE_FONT_PROPERTIES, FontConfigFontPropertiesClass))

typedef struct _FontConfigFontProperties FontConfigFontProperties;
typedef struct _FontConfigFontPropertiesClass FontConfigFontPropertiesClass;
typedef struct _FontConfigFontPropertiesPrivate FontConfigFontPropertiesPrivate;

#define TYPE_CACHEABLE (cacheable_get_type ())
#define CACHEABLE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_CACHEABLE, Cacheable))
#define CACHEABLE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_CACHEABLE, CacheableClass))
#define IS_CACHEABLE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_CACHEABLE))
#define IS_CACHEABLE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_CACHEABLE))
#define CACHEABLE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_CACHEABLE, CacheableClass))

typedef struct _Cacheable Cacheable;
typedef struct _CacheableClass CacheableClass;

#define FONT_CONFIG_TYPE_FONT (font_config_font_get_type ())
#define FONT_CONFIG_FONT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FONT_CONFIG_TYPE_FONT, FontConfigFont))
#define FONT_CONFIG_FONT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FONT_CONFIG_TYPE_FONT, FontConfigFontClass))
#define FONT_CONFIG_IS_FONT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FONT_CONFIG_TYPE_FONT))
#define FONT_CONFIG_IS_FONT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FONT_CONFIG_TYPE_FONT))
#define FONT_CONFIG_FONT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FONT_CONFIG_TYPE_FONT, FontConfigFontClass))

typedef struct _FontConfigFont FontConfigFont;
typedef struct _FontConfigFontClass FontConfigFontClass;
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

struct _FontConfigProperties {
	GObject parent_instance;
	FontConfigPropertiesPrivate * priv;
	GeeArrayList* skip_property_assignment;
};

struct _FontConfigPropertiesClass {
	GObjectClass parent_class;
	gchar* (*get_config_file) (FontConfigProperties* self);
	void (*reset_properties) (FontConfigProperties* self);
	gboolean (*load) (FontConfigProperties* self, const gchar* target);
	gboolean (*save) (FontConfigProperties* self);
	gboolean (*discard) (FontConfigProperties* self);
	void (*load_assignments) (FontConfigProperties* self, const gchar* target_file);
	void (*parse_edit_node) (FontConfigProperties* self, xmlNode* iter);
	void (*parse_test_node) (FontConfigProperties* self, xmlNode* iter);
	void (*parse_node) (FontConfigProperties* self, xmlNode* node);
	gchar* (*type_to_string) (FontConfigProperties* self, GType t);
	gchar* (*value_to_string) (FontConfigProperties* self, const gchar* type, GValue* val);
	void (*write_assignments) (FontConfigProperties* self, FontConfigXmlWriter* writer);
	void (*write_match_criteria) (FontConfigProperties* self, FontConfigXmlWriter* writer);
};

struct _FontConfigDefaultProperties {
	FontConfigProperties parent_instance;
	FontConfigDefaultPropertiesPrivate * priv;
};

struct _FontConfigDefaultPropertiesClass {
	FontConfigPropertiesClass parent_class;
};

struct _FontConfigFontProperties {
	FontConfigDefaultProperties parent_instance;
	FontConfigFontPropertiesPrivate * priv;
};

struct _FontConfigFontPropertiesClass {
	FontConfigDefaultPropertiesClass parent_class;
};

struct _FontConfigFontPropertiesPrivate {
	gdouble _less;
	gdouble _more;
	gchar* _family;
	FontConfigFont* _font;
};


static gpointer font_config_font_properties_parent_class = NULL;

GType font_config_properties_get_type (void) G_GNUC_CONST;
GType font_config_default_properties_get_type (void) G_GNUC_CONST;
GType font_config_font_properties_get_type (void) G_GNUC_CONST;
GType cacheable_get_type (void) G_GNUC_CONST;
GType font_config_font_get_type (void) G_GNUC_CONST;
#define FONT_CONFIG_FONT_PROPERTIES_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), FONT_CONFIG_TYPE_FONT_PROPERTIES, FontConfigFontPropertiesPrivate))
enum  {
	FONT_CONFIG_FONT_PROPERTIES_DUMMY_PROPERTY,
	FONT_CONFIG_FONT_PROPERTIES_LESS,
	FONT_CONFIG_FONT_PROPERTIES_MORE,
	FONT_CONFIG_FONT_PROPERTIES_FAMILY,
	FONT_CONFIG_FONT_PROPERTIES_FONT
};
static void font_config_font_properties_real_reset_properties (FontConfigProperties* base);
void font_config_font_properties_set_less (FontConfigFontProperties* self, gdouble value);
void font_config_font_properties_set_more (FontConfigFontProperties* self, gdouble value);
void font_config_properties_reset_properties (FontConfigProperties* self);
static gboolean font_config_font_properties_real_save (FontConfigProperties* base);
gdouble font_config_font_properties_get_less (FontConfigFontProperties* self);
gdouble font_config_font_properties_get_more (FontConfigFontProperties* self);
gboolean font_config_properties_save (FontConfigProperties* self);
gchar* font_config_font_properties_get_config_file (FontConfigFontProperties* self, gboolean get_default);
FontConfigFont* font_config_font_properties_get_font (FontConfigFontProperties* self);
gchar* font_config_get_config_dir (void);
gchar* font_config_font_to_filename (FontConfigFont* self);
const gchar* font_config_font_properties_get_family (FontConfigFontProperties* self);
gchar* font_config_properties_get_config_file (FontConfigProperties* self);
static gboolean font_config_font_properties_real_load (FontConfigProperties* base, const gchar* target);
const gchar* font_config_properties_get_target_file (FontConfigProperties* self);
gboolean font_config_properties_load (FontConfigProperties* self, const gchar* target);
static void font_config_font_properties_real_parse_test_node (FontConfigProperties* base, xmlNode* iter);
static void font_config_font_properties_real_write_match_criteria (FontConfigProperties* base, FontConfigXmlWriter* writer);
void font_config_xml_writer_write_comparison (FontConfigXmlWriter* self, const gchar* name, const gchar* test, const gchar* type, const gchar* val);
gint font_config_font_get_slant (FontConfigFont* self);
gint font_config_font_get_weight (FontConfigFont* self);
gint font_config_font_get_width (FontConfigFont* self);
FontConfigFontProperties* font_config_font_properties_new (void);
FontConfigFontProperties* font_config_font_properties_construct (GType object_type);
FontConfigDefaultProperties* font_config_default_properties_new (void);
FontConfigDefaultProperties* font_config_default_properties_construct (GType object_type);
void font_config_font_properties_set_family (FontConfigFontProperties* self, const gchar* value);
const gchar* font_config_font_get_family (FontConfigFont* self);
void font_config_font_properties_set_font (FontConfigFontProperties* self, FontConfigFont* value);
static void font_config_font_properties_finalize (GObject* obj);
static void _vala_font_config_font_properties_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_font_config_font_properties_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);


static void font_config_font_properties_real_reset_properties (FontConfigProperties* base) {
	FontConfigFontProperties * self;
	self = (FontConfigFontProperties*) base;
	font_config_font_properties_set_less (self, 0.0);
	font_config_font_properties_set_more (self, 0.0);
	FONT_CONFIG_PROPERTIES_CLASS (font_config_font_properties_parent_class)->reset_properties ((FontConfigProperties*) G_TYPE_CHECK_INSTANCE_CAST (self, FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultProperties));
	return;
}


static gboolean font_config_font_properties_real_save (FontConfigProperties* base) {
	FontConfigFontProperties * self;
	gboolean result = FALSE;
	gdouble _tmp0_ = 0.0;
	gdouble _tmp3_ = 0.0;
	gboolean _tmp6_ = FALSE;
	self = (FontConfigFontProperties*) base;
	_tmp0_ = self->priv->_less;
	if (_tmp0_ != 0.0) {
		GeeArrayList* _tmp1_ = NULL;
		_tmp1_ = ((FontConfigProperties*) self)->skip_property_assignment;
		gee_abstract_collection_remove ((GeeAbstractCollection*) _tmp1_, "less");
	} else {
		GeeArrayList* _tmp2_ = NULL;
		_tmp2_ = ((FontConfigProperties*) self)->skip_property_assignment;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp2_, "less");
	}
	_tmp3_ = self->priv->_more;
	if (_tmp3_ != 0.0) {
		GeeArrayList* _tmp4_ = NULL;
		_tmp4_ = ((FontConfigProperties*) self)->skip_property_assignment;
		gee_abstract_collection_remove ((GeeAbstractCollection*) _tmp4_, "more");
	} else {
		GeeArrayList* _tmp5_ = NULL;
		_tmp5_ = ((FontConfigProperties*) self)->skip_property_assignment;
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp5_, "more");
	}
	_tmp6_ = FONT_CONFIG_PROPERTIES_CLASS (font_config_font_properties_parent_class)->save ((FontConfigProperties*) G_TYPE_CHECK_INSTANCE_CAST (self, FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultProperties));
	result = _tmp6_;
	return result;
}


gchar* font_config_font_properties_get_config_file (FontConfigFontProperties* self, gboolean get_default) {
	gchar* result = NULL;
	gboolean _tmp0_ = FALSE;
	FontConfigFont* _tmp1_ = NULL;
	FontConfigFont* _tmp2_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp1_ = font_config_font_properties_get_font (self);
	_tmp2_ = _tmp1_;
	if (_tmp2_ != NULL) {
		gboolean _tmp3_ = FALSE;
		_tmp3_ = get_default;
		_tmp0_ = !_tmp3_;
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		gchar* _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		FontConfigFont* _tmp6_ = NULL;
		FontConfigFont* _tmp7_ = NULL;
		gchar* _tmp8_ = NULL;
		gchar* _tmp9_ = NULL;
		gchar* _tmp10_ = NULL;
		gchar* _tmp11_ = NULL;
		gchar* _tmp12_ = NULL;
		gchar* _tmp13_ = NULL;
		_tmp4_ = font_config_get_config_dir ();
		_tmp5_ = _tmp4_;
		_tmp6_ = font_config_font_properties_get_font (self);
		_tmp7_ = _tmp6_;
		_tmp8_ = font_config_font_to_filename (_tmp7_);
		_tmp9_ = _tmp8_;
		_tmp10_ = g_strdup_printf ("29-%s-Properties.conf", _tmp9_);
		_tmp11_ = _tmp10_;
		_tmp12_ = g_build_filename (_tmp5_, _tmp11_, NULL);
		_tmp13_ = _tmp12_;
		_g_free0 (_tmp11_);
		_g_free0 (_tmp9_);
		_g_free0 (_tmp5_);
		result = _tmp13_;
		return result;
	} else {
		const gchar* _tmp14_ = NULL;
		const gchar* _tmp15_ = NULL;
		_tmp14_ = font_config_font_properties_get_family (self);
		_tmp15_ = _tmp14_;
		if (_tmp15_ != NULL) {
			gchar* _tmp16_ = NULL;
			gchar* _tmp17_ = NULL;
			const gchar* _tmp18_ = NULL;
			const gchar* _tmp19_ = NULL;
			gchar* _tmp20_ = NULL;
			gchar* _tmp21_ = NULL;
			gchar* _tmp22_ = NULL;
			gchar* _tmp23_ = NULL;
			_tmp16_ = font_config_get_config_dir ();
			_tmp17_ = _tmp16_;
			_tmp18_ = font_config_font_properties_get_family (self);
			_tmp19_ = _tmp18_;
			_tmp20_ = g_strdup_printf ("29-%s-Properties.conf", _tmp19_);
			_tmp21_ = _tmp20_;
			_tmp22_ = g_build_filename (_tmp17_, _tmp21_, NULL);
			_tmp23_ = _tmp22_;
			_g_free0 (_tmp21_);
			_g_free0 (_tmp17_);
			result = _tmp23_;
			return result;
		} else {
			gchar* _tmp24_ = NULL;
			_tmp24_ = FONT_CONFIG_PROPERTIES_CLASS (font_config_font_properties_parent_class)->get_config_file ((FontConfigProperties*) G_TYPE_CHECK_INSTANCE_CAST (self, FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultProperties));
			result = _tmp24_;
			return result;
		}
	}
}


static gboolean font_config_font_properties_real_load (FontConfigProperties* base, const gchar* target) {
	FontConfigFontProperties * self;
	gboolean result = FALSE;
	const gchar* _tmp0_ = NULL;
	const gchar* _tmp3_ = NULL;
	gchar* _tmp4_ = NULL;
	gchar* _tmp5_ = NULL;
	gchar* _tmp6_ = NULL;
	gchar* _tmp7_ = NULL;
	self = (FontConfigFontProperties*) base;
	_tmp0_ = target;
	if (_tmp0_ == NULL) {
		const gchar* _tmp1_ = NULL;
		const gchar* _tmp2_ = NULL;
		_tmp1_ = font_config_properties_get_target_file ((FontConfigProperties*) self);
		_tmp2_ = _tmp1_;
		target = _tmp2_;
	}
	_tmp3_ = target;
	FONT_CONFIG_PROPERTIES_CLASS (font_config_font_properties_parent_class)->load ((FontConfigProperties*) G_TYPE_CHECK_INSTANCE_CAST (self, FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultProperties), _tmp3_);
	_tmp4_ = font_config_font_properties_get_config_file (self, TRUE);
	_tmp5_ = _tmp4_;
	FONT_CONFIG_PROPERTIES_CLASS (font_config_font_properties_parent_class)->load ((FontConfigProperties*) G_TYPE_CHECK_INSTANCE_CAST (self, FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultProperties), _tmp5_);
	_g_free0 (_tmp5_);
	_tmp6_ = font_config_font_properties_get_config_file (self, FALSE);
	_tmp7_ = _tmp6_;
	FONT_CONFIG_PROPERTIES_CLASS (font_config_font_properties_parent_class)->load ((FontConfigProperties*) G_TYPE_CHECK_INSTANCE_CAST (self, FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, FontConfigDefaultProperties), _tmp7_);
	_g_free0 (_tmp7_);
	result = TRUE;
	return result;
}


static gdouble double_parse (const gchar* str) {
	gdouble result = 0.0;
	const gchar* _tmp0_ = NULL;
	gdouble _tmp1_ = 0.0;
	g_return_val_if_fail (str != NULL, 0.0);
	_tmp0_ = str;
	_tmp1_ = g_ascii_strtod (_tmp0_, NULL);
	result = _tmp1_;
	return result;
}


static void font_config_font_properties_real_parse_test_node (FontConfigProperties* base, xmlNode* iter) {
	FontConfigFontProperties * self;
	gchar* ptype = NULL;
	gchar* pval = NULL;
	const gchar* _tmp36_ = NULL;
	self = (FontConfigFontProperties*) base;
	ptype = NULL;
	pval = NULL;
	{
		xmlAttr* prop = NULL;
		xmlNode* _tmp0_ = NULL;
		xmlAttr* _tmp1_ = NULL;
		_tmp0_ = iter;
		_tmp1_ = _tmp0_->properties;
		prop = _tmp1_;
		{
			gboolean _tmp2_ = FALSE;
			_tmp2_ = TRUE;
			while (TRUE) {
				xmlAttr* _tmp5_ = NULL;
				gboolean _tmp6_ = FALSE;
				xmlAttr* _tmp7_ = NULL;
				const gchar* _tmp8_ = NULL;
				if (!_tmp2_) {
					xmlAttr* _tmp3_ = NULL;
					xmlAttr* _tmp4_ = NULL;
					_tmp3_ = prop;
					_tmp4_ = _tmp3_->next;
					prop = _tmp4_;
				}
				_tmp2_ = FALSE;
				_tmp5_ = prop;
				if (!(_tmp5_ != NULL)) {
					break;
				}
				_tmp7_ = prop;
				_tmp8_ = _tmp7_->name;
				if (g_strcmp0 (_tmp8_, "name") == 0) {
					xmlAttr* _tmp9_ = NULL;
					xmlNode* _tmp10_ = NULL;
					const gchar* _tmp11_ = NULL;
					_tmp9_ = prop;
					_tmp10_ = _tmp9_->children;
					_tmp11_ = _tmp10_->content;
					_tmp6_ = g_strcmp0 (_tmp11_, "size") == 0;
				} else {
					_tmp6_ = FALSE;
				}
				if (_tmp6_) {
					continue;
				} else {
					gboolean _tmp12_ = FALSE;
					gboolean _tmp13_ = FALSE;
					xmlAttr* _tmp14_ = NULL;
					const gchar* _tmp15_ = NULL;
					_tmp14_ = prop;
					_tmp15_ = _tmp14_->name;
					if (g_strcmp0 (_tmp15_, "compare") == 0) {
						xmlAttr* _tmp16_ = NULL;
						xmlNode* _tmp17_ = NULL;
						const gchar* _tmp18_ = NULL;
						_tmp16_ = prop;
						_tmp17_ = _tmp16_->children;
						_tmp18_ = _tmp17_->content;
						_tmp13_ = g_strcmp0 (_tmp18_, "less") == 0;
					} else {
						_tmp13_ = FALSE;
					}
					if (_tmp13_) {
						_tmp12_ = TRUE;
					} else {
						xmlAttr* _tmp19_ = NULL;
						xmlNode* _tmp20_ = NULL;
						const gchar* _tmp21_ = NULL;
						_tmp19_ = prop;
						_tmp20_ = _tmp19_->children;
						_tmp21_ = _tmp20_->content;
						_tmp12_ = g_strcmp0 (_tmp21_, "more") == 0;
					}
					if (_tmp12_) {
						{
							xmlNode* val = NULL;
							xmlNode* _tmp22_ = NULL;
							xmlNode* _tmp23_ = NULL;
							_tmp22_ = iter;
							_tmp23_ = _tmp22_->children;
							val = _tmp23_;
							{
								gboolean _tmp24_ = FALSE;
								_tmp24_ = TRUE;
								while (TRUE) {
									xmlNode* _tmp27_ = NULL;
									xmlNode* _tmp28_ = NULL;
									const gchar* _tmp29_ = NULL;
									if (!_tmp24_) {
										xmlNode* _tmp25_ = NULL;
										xmlNode* _tmp26_ = NULL;
										_tmp25_ = val;
										_tmp26_ = _tmp25_->next;
										val = _tmp26_;
									}
									_tmp24_ = FALSE;
									_tmp27_ = val;
									if (!(_tmp27_ != NULL)) {
										break;
									}
									_tmp28_ = val;
									_tmp29_ = _tmp28_->name;
									if (g_strcmp0 (_tmp29_, "double") == 0) {
										xmlAttr* _tmp30_ = NULL;
										xmlNode* _tmp31_ = NULL;
										const gchar* _tmp32_ = NULL;
										gchar* _tmp33_ = NULL;
										xmlNode* _tmp34_ = NULL;
										gchar* _tmp35_ = NULL;
										_tmp30_ = prop;
										_tmp31_ = _tmp30_->children;
										_tmp32_ = _tmp31_->content;
										_tmp33_ = g_strdup (_tmp32_);
										_g_free0 (ptype);
										ptype = _tmp33_;
										_tmp34_ = val;
										_tmp35_ = (gchar*) xmlNodeGetContent (_tmp34_);
										_g_free0 (pval);
										pval = _tmp35_;
										break;
									}
								}
							}
						}
					} else {
						break;
					}
				}
			}
		}
	}
	_tmp36_ = pval;
	if (_tmp36_ != NULL) {
		const gchar* _tmp37_ = NULL;
		_tmp37_ = ptype;
		if (g_strcmp0 (_tmp37_, "less") == 0) {
			const gchar* _tmp38_ = NULL;
			gdouble _tmp39_ = 0.0;
			_tmp38_ = pval;
			_tmp39_ = double_parse (_tmp38_);
			font_config_font_properties_set_less (self, _tmp39_);
		} else {
			const gchar* _tmp40_ = NULL;
			_tmp40_ = ptype;
			if (g_strcmp0 (_tmp40_, "more") == 0) {
				const gchar* _tmp41_ = NULL;
				gdouble _tmp42_ = 0.0;
				_tmp41_ = pval;
				_tmp42_ = double_parse (_tmp41_);
				font_config_font_properties_set_more (self, _tmp42_);
			}
		}
	}
	_g_free0 (pval);
	_g_free0 (ptype);
	return;
}


static gchar* double_to_string (gdouble self) {
	gchar* result = NULL;
	gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	gint _tmp1__length1 = 0;
	const gchar* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	gchar* _tmp4_ = NULL;
	_tmp0_ = g_new0 (gchar, G_ASCII_DTOSTR_BUF_SIZE);
	_tmp1_ = _tmp0_;
	_tmp1__length1 = G_ASCII_DTOSTR_BUF_SIZE;
	_tmp2_ = g_ascii_dtostr (_tmp1_, G_ASCII_DTOSTR_BUF_SIZE, self);
	_tmp3_ = g_strdup (_tmp2_);
	_tmp4_ = _tmp3_;
	_tmp1_ = (g_free (_tmp1_), NULL);
	result = _tmp4_;
	return result;
}


static void font_config_font_properties_real_write_match_criteria (FontConfigProperties* base, FontConfigXmlWriter* writer) {
	FontConfigFontProperties * self;
	gboolean _tmp0_ = FALSE;
	const gchar* _tmp1_ = NULL;
	const gchar* _tmp2_ = NULL;
	FontConfigXmlWriter* _tmp5_ = NULL;
	FontConfigXmlWriter* _tmp6_ = NULL;
	FontConfigXmlWriter* _tmp7_ = NULL;
	const gchar* _tmp8_ = NULL;
	const gchar* _tmp9_ = NULL;
	FontConfigXmlWriter* _tmp10_ = NULL;
	gdouble _tmp11_ = 0.0;
	gdouble _tmp16_ = 0.0;
	FontConfigFont* _tmp21_ = NULL;
	FontConfigFont* _tmp22_ = NULL;
	FontConfigXmlWriter* _tmp23_ = NULL;
	FontConfigFont* _tmp24_ = NULL;
	FontConfigFont* _tmp25_ = NULL;
	gint _tmp26_ = 0;
	gint _tmp27_ = 0;
	gchar* _tmp28_ = NULL;
	gchar* _tmp29_ = NULL;
	FontConfigXmlWriter* _tmp30_ = NULL;
	FontConfigFont* _tmp31_ = NULL;
	FontConfigFont* _tmp32_ = NULL;
	gint _tmp33_ = 0;
	gint _tmp34_ = 0;
	gchar* _tmp35_ = NULL;
	gchar* _tmp36_ = NULL;
	FontConfigXmlWriter* _tmp37_ = NULL;
	FontConfigFont* _tmp38_ = NULL;
	FontConfigFont* _tmp39_ = NULL;
	gint _tmp40_ = 0;
	gint _tmp41_ = 0;
	gchar* _tmp42_ = NULL;
	gchar* _tmp43_ = NULL;
	self = (FontConfigFontProperties*) base;
	g_return_if_fail (writer != NULL);
	_tmp1_ = font_config_font_properties_get_family (self);
	_tmp2_ = _tmp1_;
	if (_tmp2_ == NULL) {
		FontConfigFont* _tmp3_ = NULL;
		FontConfigFont* _tmp4_ = NULL;
		_tmp3_ = font_config_font_properties_get_font (self);
		_tmp4_ = _tmp3_;
		_tmp0_ = _tmp4_ == NULL;
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		return;
	}
	_tmp5_ = writer;
	xmlTextWriterStartElement ((xmlTextWriter*) _tmp5_, (xmlChar*) "test");
	_tmp6_ = writer;
	xmlTextWriterWriteAttribute ((xmlTextWriter*) _tmp6_, (xmlChar*) "name", (xmlChar*) "family");
	_tmp7_ = writer;
	_tmp8_ = font_config_font_properties_get_family (self);
	_tmp9_ = _tmp8_;
	xmlTextWriterWriteElement ((xmlTextWriter*) _tmp7_, (xmlChar*) "string", (xmlChar*) _tmp9_);
	_tmp10_ = writer;
	xmlTextWriterEndElement ((xmlTextWriter*) _tmp10_);
	_tmp11_ = self->priv->_less;
	if (_tmp11_ != 0.0) {
		FontConfigXmlWriter* _tmp12_ = NULL;
		gdouble _tmp13_ = 0.0;
		gchar* _tmp14_ = NULL;
		gchar* _tmp15_ = NULL;
		_tmp12_ = writer;
		_tmp13_ = self->priv->_less;
		_tmp14_ = double_to_string (_tmp13_);
		_tmp15_ = _tmp14_;
		font_config_xml_writer_write_comparison (_tmp12_, "size", "less", "double", _tmp15_);
		_g_free0 (_tmp15_);
	}
	_tmp16_ = self->priv->_more;
	if (_tmp16_ != 0.0) {
		FontConfigXmlWriter* _tmp17_ = NULL;
		gdouble _tmp18_ = 0.0;
		gchar* _tmp19_ = NULL;
		gchar* _tmp20_ = NULL;
		_tmp17_ = writer;
		_tmp18_ = self->priv->_more;
		_tmp19_ = double_to_string (_tmp18_);
		_tmp20_ = _tmp19_;
		font_config_xml_writer_write_comparison (_tmp17_, "size", "more", "double", _tmp20_);
		_g_free0 (_tmp20_);
	}
	_tmp21_ = font_config_font_properties_get_font (self);
	_tmp22_ = _tmp21_;
	if (_tmp22_ == NULL) {
		return;
	}
	_tmp23_ = writer;
	_tmp24_ = font_config_font_properties_get_font (self);
	_tmp25_ = _tmp24_;
	_tmp26_ = font_config_font_get_slant (_tmp25_);
	_tmp27_ = _tmp26_;
	_tmp28_ = g_strdup_printf ("%i", _tmp27_);
	_tmp29_ = _tmp28_;
	font_config_xml_writer_write_comparison (_tmp23_, "slant", "eq", "int", _tmp29_);
	_g_free0 (_tmp29_);
	_tmp30_ = writer;
	_tmp31_ = font_config_font_properties_get_font (self);
	_tmp32_ = _tmp31_;
	_tmp33_ = font_config_font_get_weight (_tmp32_);
	_tmp34_ = _tmp33_;
	_tmp35_ = g_strdup_printf ("%i", _tmp34_);
	_tmp36_ = _tmp35_;
	font_config_xml_writer_write_comparison (_tmp30_, "weight", "eq", "int", _tmp36_);
	_g_free0 (_tmp36_);
	_tmp37_ = writer;
	_tmp38_ = font_config_font_properties_get_font (self);
	_tmp39_ = _tmp38_;
	_tmp40_ = font_config_font_get_width (_tmp39_);
	_tmp41_ = _tmp40_;
	_tmp42_ = g_strdup_printf ("%i", _tmp41_);
	_tmp43_ = _tmp42_;
	font_config_xml_writer_write_comparison (_tmp37_, "width", "eq", "int", _tmp43_);
	_g_free0 (_tmp43_);
	return;
}


FontConfigFontProperties* font_config_font_properties_construct (GType object_type) {
	FontConfigFontProperties * self = NULL;
	self = (FontConfigFontProperties*) font_config_default_properties_construct (object_type);
	return self;
}


FontConfigFontProperties* font_config_font_properties_new (void) {
	return font_config_font_properties_construct (FONT_CONFIG_TYPE_FONT_PROPERTIES);
}


gdouble font_config_font_properties_get_less (FontConfigFontProperties* self) {
	gdouble result;
	gdouble _tmp0_ = 0.0;
	g_return_val_if_fail (self != NULL, 0.0);
	_tmp0_ = self->priv->_less;
	result = _tmp0_;
	return result;
}


void font_config_font_properties_set_less (FontConfigFontProperties* self, gdouble value) {
	gdouble _tmp0_ = 0.0;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	self->priv->_less = _tmp0_;
	g_object_notify ((GObject *) self, "less");
}


gdouble font_config_font_properties_get_more (FontConfigFontProperties* self) {
	gdouble result;
	gdouble _tmp0_ = 0.0;
	g_return_val_if_fail (self != NULL, 0.0);
	_tmp0_ = self->priv->_more;
	result = _tmp0_;
	return result;
}


void font_config_font_properties_set_more (FontConfigFontProperties* self, gdouble value) {
	gdouble _tmp0_ = 0.0;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	self->priv->_more = _tmp0_;
	g_object_notify ((GObject *) self, "more");
}


const gchar* font_config_font_properties_get_family (FontConfigFontProperties* self) {
	const gchar* result;
	const gchar* _tmp0_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_family;
	result = _tmp0_;
	return result;
}


void font_config_font_properties_set_family (FontConfigFontProperties* self, const gchar* value) {
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	gboolean _tmp2_ = FALSE;
	FontConfigFont* _tmp3_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_tmp1_ = g_strdup (_tmp0_);
	_g_free0 (self->priv->_family);
	self->priv->_family = _tmp1_;
	_tmp3_ = self->priv->_font;
	if (_tmp3_ != NULL) {
		FontConfigFont* _tmp4_ = NULL;
		const gchar* _tmp5_ = NULL;
		const gchar* _tmp6_ = NULL;
		const gchar* _tmp7_ = NULL;
		const gchar* _tmp8_ = NULL;
		_tmp4_ = self->priv->_font;
		_tmp5_ = font_config_font_get_family (_tmp4_);
		_tmp6_ = _tmp5_;
		_tmp7_ = font_config_font_properties_get_family (self);
		_tmp8_ = _tmp7_;
		_tmp2_ = g_strcmp0 (_tmp6_, _tmp8_) != 0;
	} else {
		_tmp2_ = FALSE;
	}
	if (_tmp2_) {
		_g_object_unref0 (self->priv->_font);
		self->priv->_font = NULL;
	}
	font_config_properties_reset_properties ((FontConfigProperties*) self);
	font_config_properties_load ((FontConfigProperties*) self, NULL);
	g_object_notify ((GObject *) self, "family");
}


FontConfigFont* font_config_font_properties_get_font (FontConfigFontProperties* self) {
	FontConfigFont* result;
	FontConfigFont* _tmp0_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_font;
	result = _tmp0_;
	return result;
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


void font_config_font_properties_set_font (FontConfigFontProperties* self, FontConfigFont* value) {
	FontConfigFont* _tmp0_ = NULL;
	FontConfigFont* _tmp1_ = NULL;
	FontConfigFont* _tmp2_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_font);
	self->priv->_font = _tmp1_;
	_tmp2_ = self->priv->_font;
	if (_tmp2_ != NULL) {
		FontConfigFont* _tmp3_ = NULL;
		const gchar* _tmp4_ = NULL;
		const gchar* _tmp5_ = NULL;
		gchar* _tmp6_ = NULL;
		_tmp3_ = self->priv->_font;
		_tmp4_ = font_config_font_get_family (_tmp3_);
		_tmp5_ = _tmp4_;
		_tmp6_ = g_strdup (_tmp5_);
		_g_free0 (self->priv->_family);
		self->priv->_family = _tmp6_;
	} else {
		_g_free0 (self->priv->_family);
		self->priv->_family = NULL;
	}
	font_config_properties_reset_properties ((FontConfigProperties*) self);
	font_config_properties_load ((FontConfigProperties*) self, NULL);
	g_object_notify ((GObject *) self, "font");
}


static void font_config_font_properties_class_init (FontConfigFontPropertiesClass * klass) {
	font_config_font_properties_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (FontConfigFontPropertiesPrivate));
	((FontConfigPropertiesClass *) klass)->reset_properties = font_config_font_properties_real_reset_properties;
	((FontConfigPropertiesClass *) klass)->save = font_config_font_properties_real_save;
	((FontConfigPropertiesClass *) klass)->load = font_config_font_properties_real_load;
	((FontConfigPropertiesClass *) klass)->parse_test_node = font_config_font_properties_real_parse_test_node;
	((FontConfigPropertiesClass *) klass)->write_match_criteria = font_config_font_properties_real_write_match_criteria;
	G_OBJECT_CLASS (klass)->get_property = _vala_font_config_font_properties_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_font_config_font_properties_set_property;
	G_OBJECT_CLASS (klass)->finalize = font_config_font_properties_finalize;
	g_object_class_install_property (G_OBJECT_CLASS (klass), FONT_CONFIG_FONT_PROPERTIES_LESS, g_param_spec_double ("less", "less", "less", -G_MAXDOUBLE, G_MAXDOUBLE, 0.0, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), FONT_CONFIG_FONT_PROPERTIES_MORE, g_param_spec_double ("more", "more", "more", -G_MAXDOUBLE, G_MAXDOUBLE, 0.0, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), FONT_CONFIG_FONT_PROPERTIES_FAMILY, g_param_spec_string ("family", "family", "family", NULL, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), FONT_CONFIG_FONT_PROPERTIES_FONT, g_param_spec_object ("font", "font", "font", FONT_CONFIG_TYPE_FONT, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
}


static void font_config_font_properties_instance_init (FontConfigFontProperties * self) {
	self->priv = FONT_CONFIG_FONT_PROPERTIES_GET_PRIVATE (self);
	self->priv->_less = 0.0;
	self->priv->_more = 0.0;
	self->priv->_family = NULL;
	self->priv->_font = NULL;
}


static void font_config_font_properties_finalize (GObject* obj) {
	FontConfigFontProperties * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, FONT_CONFIG_TYPE_FONT_PROPERTIES, FontConfigFontProperties);
	_g_free0 (self->priv->_family);
	_g_object_unref0 (self->priv->_font);
	G_OBJECT_CLASS (font_config_font_properties_parent_class)->finalize (obj);
}


GType font_config_font_properties_get_type (void) {
	static volatile gsize font_config_font_properties_type_id__volatile = 0;
	if (g_once_init_enter (&font_config_font_properties_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (FontConfigFontPropertiesClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) font_config_font_properties_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (FontConfigFontProperties), 0, (GInstanceInitFunc) font_config_font_properties_instance_init, NULL };
		GType font_config_font_properties_type_id;
		font_config_font_properties_type_id = g_type_register_static (FONT_CONFIG_TYPE_DEFAULT_PROPERTIES, "FontConfigFontProperties", &g_define_type_info, 0);
		g_once_init_leave (&font_config_font_properties_type_id__volatile, font_config_font_properties_type_id);
	}
	return font_config_font_properties_type_id__volatile;
}


static void _vala_font_config_font_properties_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	FontConfigFontProperties * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, FONT_CONFIG_TYPE_FONT_PROPERTIES, FontConfigFontProperties);
	switch (property_id) {
		case FONT_CONFIG_FONT_PROPERTIES_LESS:
		g_value_set_double (value, font_config_font_properties_get_less (self));
		break;
		case FONT_CONFIG_FONT_PROPERTIES_MORE:
		g_value_set_double (value, font_config_font_properties_get_more (self));
		break;
		case FONT_CONFIG_FONT_PROPERTIES_FAMILY:
		g_value_set_string (value, font_config_font_properties_get_family (self));
		break;
		case FONT_CONFIG_FONT_PROPERTIES_FONT:
		g_value_set_object (value, font_config_font_properties_get_font (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_font_config_font_properties_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	FontConfigFontProperties * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, FONT_CONFIG_TYPE_FONT_PROPERTIES, FontConfigFontProperties);
	switch (property_id) {
		case FONT_CONFIG_FONT_PROPERTIES_LESS:
		font_config_font_properties_set_less (self, g_value_get_double (value));
		break;
		case FONT_CONFIG_FONT_PROPERTIES_MORE:
		font_config_font_properties_set_more (self, g_value_get_double (value));
		break;
		case FONT_CONFIG_FONT_PROPERTIES_FAMILY:
		font_config_font_properties_set_family (self, g_value_get_string (value));
		break;
		case FONT_CONFIG_FONT_PROPERTIES_FONT:
		font_config_font_properties_set_font (self, g_value_get_object (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}



